---
title: "jaenna_data_exploration"
author: "Jaenna Wessling"
date: "2023-02-28"
output: html_document
---

```{r setup, include=FALSE, warning = FALSE, message = FALSE}
knitr::opts_chunk$set(echo = FALSE, include=FALSE, warning = FALSE, message = FALSE)

library(here)
library(tidyverse)
library(ggplot2)
library(ggpubr)
library(patchwork)
library(kableExtra)
library(dplyr)
```

### Load in the new data

```{r}
days_exceed <- read_csv(here("Tab3_Days_ExceedHealthBenchmarks.csv"))

summary(days_exceed)

### By species 
### Days invert sed = max 381
### Days invertebrate water = max 250
### Days plant non-vascular = max 190 


### Days any species = max 381 (going to be from days invert sed
unique(days_exceed$huc)
```


### Plan of action
## Drop down menu to see days of exceedance by species & pesticide type 


### Wrangle by species

#### Fish
```{r}
fish <- days_exceed %>% 
  select(huc, days_fish, pesticide) %>% 
  slice_max(days_fish, n = 10) %>% # keeping the largest values of the counts by lake 
  arrange(-days_fish) # arranges selected choices from greatest to least 

## Plot it 
ggplot(data = fish, aes(y = days_fish, x = huc, fill = pesticide)) +  
  scale_x_discrete(limits = fish$huc) + 
  geom_col() +
  labs(y = 'Days of Exceedance', x = "Watershed",
       title = "Greatest Days of Exceedance for Fish Species") + 
  theme(axis.text.x = element_text(angle =75, hjust = 1))
```


#### Inverts water
```{r}
invert_water <- days_exceed %>% 
  select(days_invertebrate_water, pesticide, huc) %>% 
  slice_max(days_invertebrate_water, n = 10) %>% # keeping the largest values of the counts by lake 
  arrange(-days_invertebrate_water) # arranges selected choices from greatest to least 


## Plot it 
ggplot(data = invert_water, aes(y = days_invertebrate_water, x = huc, fill = pesticide)) +  
  scale_x_discrete(limits = invert_water$huc) + 
  geom_col() +
  labs(y = 'Days of Exceedance', x = "Watershed",
       title = "Greatest Days of Exceedance for Aquatic Invertabrate Species") + 
  theme(axis.text.x = element_text(angle =75, hjust = 1))
```


#### Inverts sediment
```{r}
invert_sed <- days_exceed %>% 
  select(days_invertebrate_sed, pesticide, huc) %>% 
  slice_max(days_invertebrate_sed, n = 10) %>% # keeping the largest values of the counts by lake 
  arrange(-days_invertebrate_sed) # arranges selected choices from greatest to least 


## Plot it 
ggplot(data = invert_sed, aes(y = days_invertebrate_sed, x = huc, fill = pesticide)) + 
  scale_x_discrete(limits = invert_sed$huc) + 
  geom_col() +
  labs(y = 'Days of Exceedance', x = "Watershed",
       title = "Greatest Days of Exceedance for Sediment Invertabrate Species") + 
  theme(axis.text.x = element_text(angle =75, hjust = 1))
```


#### Non-vascular plants 
```{r}
non_vasc_plant <- days_exceed %>% 
  select(days_plant_nonvascular, pesticide, huc) %>% 
  slice_max(days_plant_nonvascular, n = 10) %>% # keeping the largest values of the counts by lake 
  arrange(-days_plant_nonvascular) # arranges selected choices from greatest to least 

## Plot it 
ggplot(data = non_vasc_plant, aes(y = days_plant_nonvascular, 
                                  x = huc, 
                                  fill = pesticide,
                                  )) +  
  scale_x_discrete(limits = non_vasc_plant$huc) + 
  geom_col() +
  labs(y = 'Days of Exceedance', x = "Watershed",
       title = "Greatest Days of Exceedance for Non-Vascular Plant Species") + 
  theme(axis.text.x = element_text(angle =75, hjust = 1))
```

#### Vascular plants 
```{r}
vasc_plant <- days_exceed %>% 
  select(days_plant_vascular, pesticide,  huc) %>% 
  slice_max(days_plant_vascular, n = 8) %>% # keeping the largest values of the counts by lake 
  arrange(-days_plant_vascular) # arranges selected choices from greatest to least 


## Plot it 
ggplot(data = vasc_plant, aes(y = days_plant_vascular, 
                                  x = huc, 
                                  fill = pesticide,
                                  )) +  
  scale_x_discrete(limits = vasc_plant$huc) + 
  geom_col() +
  labs(y = 'Days of Exceedance', x = "Watershed",
       title = "Greatest Days of Exceedance for Vascular Plant Species") + 
  theme(axis.text.x = element_text(angle =75, hjust = 1))
```


#### All species
```{r}
all_species <- days_exceed %>% 
  select(days_any_species, pesticide, huc) %>% 
  slice_max(days_any_species, n = 10) %>% # keeping the largest values of the counts by lake 
  arrange(-days_any_species) # arranges selected choices from greatest to least 


## Plot it 
ggplot(data = all_species, aes(y = days_any_species, 
                                  x = huc, 
                                  fill = pesticide,
                                  )) +  
  scale_x_discrete(limits = all_species$huc) + 
  geom_col() +
  labs(y = 'Days of Exceedance', x = "Watershed",
       title = "Greatest Days of Exceedance for All Species") + 
  theme(axis.text.x = element_text(angle = 75, hjust = 1))
```


